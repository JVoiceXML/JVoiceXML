<project name="JVoiceXML Run Script" default="run" basedir=".">
	<description>
This file provides targets to run and stop the voice browser.
  </description>

	<import file="build.xml" />

	<target name="-run-setup" depends="-setup">
		<property name="tomcat.home" value="/usr/local/tomcat" />
		<property name="tomcat.startup" value="bin/startup.sh" />
		<property name="tomcat.shutdown" value="bin/shutdown.sh" />
		<property name="location.manifest" value="http://localhost:8080/irtest/irtests/manifest.xml" />
		<path id="run.classpath">
			<path refid="project.classpath" />
			<fileset refid="loggings.lib" />
			<fileset refid="spring.lib" />
			<pathelement location="${dist}/jvxml-client-text.jar" />
			<pathelement location="${dist}/jvxml-text.jar" />
			<pathelement path="${build}" />
			<pathelement path="./config" />
			<pathelement path="${config}" />
		</path>
	</target>

	<target name="startupTomcat" depends="-run-setup" 
			description="start up tomcat web service.">
		<echo message="startup tomcat web service."/>
		<exec dir="${tomcat.home}" executable="${tomcat.startup}"/>
		<waitfor maxwait="1" maxwaitunit="minute" checkevery="500">
		        <http url="${location.manifest}"/>
		</waitfor>
		<echo message="tomcat web service started"/>
	</target>

	<target name="shutdownTomcat" depends="-run-setup" 
		description="shutdown tomcat web service.">
		<exec dir="${tomcat.home}" executable="${tomcat.shutdown}"/>
	</target>
	
	<target name="startupJVoiceXML" depends="-run-setup" 
			description="start up JVoiceXML Interpreter.">
		<echo message="startup JVoiceXML Interpreter."/>
		<exec dir="${tomcat.home}" executable="${tomcat.startup}"/>
		<waitfor maxwait="1" maxwaitunit="minute" checkevery="500">
		        <http url="${location.manifest}"/>
		</waitfor>
		<echo message="tomcat web service started"/>
	</target>
	
	<target name="servlet.deploy">
	</target>
	
	<target name="testcases.deploy">
	</target>
	
	<target name="testWebService" depends="-run-setup" 
		description="test web service tomcat web service.">

	</target>
	
	<target name="start" depends="startupTomcat">
	</target>

	<target name="run" description="Run the VoiceXML interpreter system test" depends="jar,-run-setup">
		<java classname="org.jvoicexml.systemtest.SystemTestMain" fork="true" maxmemory="256m">
			<jvmarg value="-Djava.util.logging.config.file=${config}/java-logging.properties" />
			<jvmarg value="-Djava.security.policy=${config}/jvoicexml.policy" />
			<classpath refid="run.classpath" />
		</java>
	</target>

	<target name="debug" description="Run the VoiceXML interpreter system test in debug mode" depends="jar,-run-setup">
		<java classname="org.jvoicexml.JVoiceXmlMain" fork="true" maxmemory="256m">
			<jvmarg value="-Djava.util.logging.config.file=${config}/java-logging.properties" />
			<jvmarg value="-Djava.security.policy=${config}/jvoicexml.policy" />
			<jvmarg value="-agentlib:jdwp=transport=dt_socket,server=y,address=12367" />
			<classpath refid="run.classpath" />
		</java>
	</target>
</project>
