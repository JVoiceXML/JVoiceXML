<project name="Subdialog Demo" default="all" basedir=".">
    <description>
This file builds and runs the 'subdialog' demo for JVoiceXML.
    </description>

    <!-- allow the user to override setting in an own propertiesfile. -->
    <!-- Use the same properties file as in the main project.         -->
    <property file="../../personal-props/ant.properties" />
    <property file="../../config-props/ant.properties" />

  <!-- Load the settings for 3rdparty libraries -->
  <import file="3rdparty-libs.xml" />

  <target name="-setup" depends="-local-3rdparty-setup">
    <property name="src" value="src" />
    <property name="build" value="classes" />
    <property name="config" value="config" />

    <property name="optimize" value="off" />
    <property name="debug" value="on" />

    <!-- the used class path -->
    <path id="build.classpath">
        <path refid="jvxml.core.lib" />
        <fileset refid="log4j.lib" />
    </path>

    <path id="run.classpath">
        <path refid="build.classpath"/>
        <pathelement path="${config}"/>
        <fileset refid="rhino.lib"/>
    </path>
  </target>

    <target name="-init" depends="-setup">
        <mkdir dir="${build}" />
    </target>

    <target name="-checkJVoiceXML">
        <available classname="org.jvoicexml.JVoiceXml"
          property="jvoicexml.present" classpathref="build.classpath"/>
        <fail unless="jvoicexml.present">
Cannot find jvoicexml libraries needed to build this demo.
Build this jar from the main project first.
        </fail>
    </target>

    <target name="clean" depends="-setup"
            description="Remove all compiled and ditsribution files">
        <delete dir="${build}" />
        <delete file="${jar.file}" />
    </target>

    <target name="compile" depends="-init,-checkJVoiceXML"
            description="Compile the JAVA sources">
        <echo message="compiling with debug=${debug}, optimize=${optimize}" />
        <javac destdir="${build}"
               optimize="${optimize}" debug="${debug}" deprecation="on"
               encoding="iso-8859-1">
            <src path="${src}" />
            <include name="**/*.java" />
            <classpath refid="build.classpath" />
            <compilerarg value="-Xlint:unchecked" />
        </javac>
    </target>

    <target name="run" description="Run the 'hello world' demo"
            depends="compile">
        <java classname="org.jvoicexml.demo.subdialogdemo.SubdialogDemo"
            fork="true">
            <jvmarg value="-Djava.security.policy=${config}/jvoicexml.policy" />
            <classpath>
                <path refid="run.classpath" />
                <pathelement path="${build}"/>
            </classpath>
        </java>
  </target>

    <target name="all" depends="run" description="Run the demo"/>
</project>
